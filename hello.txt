some changes from R5
